---
import Alert from './starwind/alert/Alert.astro';
import db from '@lib/db';

let images = [];
try {
  // Récupérer directement depuis la DB les images des formations
  images = db.prepare('SELECT * FROM galerie WHERE formationsGlobal = 1 ORDER BY id ASC').all();
} catch (e) {
  console.error('Error fetching formations gallery:', e);
  images = [];
}
---
{images.length > 0 ? (
  <div class="w-full overflow-x-auto py-4">
    <div class="flex gap-6 min-w-full">
      {images.map((img: { imageUrl: string; title: string }) => (
        <div class="luxury-glass-effect rounded-2xl overflow-hidden min-w-[280px] max-w-sm flex-shrink-0 border border-luxury-primary/20 hover:border-luxury-primary/40 transition-all duration-500 hover:scale-105 group">
          <div class="relative">
            <img src={img.imageUrl} alt={img.title} class="w-full h-48 object-cover" loading="lazy" />
            <div class="absolute inset-0 bg-luxury-primary/0 group-hover:bg-luxury-primary/10 transition-all duration-500"></div>
          </div>
          <div class="p-4">
            <h4 class="text-sm font-medium text-luxury-primary text-center">{img.title}</h4>
          </div>
        </div>
      ))}
    </div>
  </div>
) : (
  <div class="luxury-glass-effect p-12 rounded-2xl text-center">
    <div class="text-luxury-primary/60 mb-4">✦</div>
    <p class="text-neutral-500">Portfolio de formations à venir prochainement.</p>
  </div>
)}
